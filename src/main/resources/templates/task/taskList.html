<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">


<th:block th:replace="${session.user_role == 'ROLE_ADMIN'} ? ~{./include/layout_admin :: setContent(~{:: .taskLists})} : ~{./include/layout_engineer :: setContent(~{:: .taskLists}) }">

<th:block class="taskLists">
	<style>


  .taskListBox {
	  border-bottom: 1px solid rgb(227, 227, 227);
	  width: 1200px;
	  margin: 0 auto;
	  text-align: center;
  }

  .taskListTable{
    width: 1200px;
    border-bottom: 1px solid rgb(227, 227, 227);
    border-collapse: collapse;
  }

  .taskHeadRow, .taskBodyRow {
	  border-bottom: 1px solid rgb(227, 227, 227);
  }
  
  .taskHeads {
    padding: 10px;
    text-align: center;
  }
  
  .taskBodies {
    padding: 10px;
    text-align: center;	  
  }

  .taskHeads:first-child, .taskBodies:first-child {
    border-left: none;
    
  }
  
  .taskContainer {
   
    
    margin: 0 auto;
  }

  .taskSearchBox {
	
	height: 100px;
	line-height: 100px;
	text-align: center;
    margin: 30px auto;
    display: inline-block;
    overflow: hidden;
    box-shadow: 0 2px 3px #777;
  }

  .taskSearchOpt {
	float: left;
	width: 330px;
	padding-right: 3px;
  }

  .taskSearchOpt > span {
	  color: black;
	  font-weight: bold;
  }

  .taskSerchInput {
    margin: 0 auto;
    text-align: center;
    
  }

  .taskSearchBtnBox {
	float: right;
	width: 150px;
	padding-right: 2px;
  }

  .taskSearchBtn {
    block-size: 30px;
    background-color: #020f37;
    color: #fff;
   	width: 70px;
   	text-align: center;
   	font-weight: bold;
  }

	.stateBtn {
		width: 80px;
		text-align: center;
		border-radius: 20px;
		background-color: blue;
		color: #fff;
		font-weight: bold;
	}
   
</style>


<body>
	
<div>
		
	
	<!-- 검색 기능 -->
	<div class="taskContainer">

	  <h3>작업조회</h3>  
	<form name="taskSearchForm" action="####" method="###">
	  <div class="taskListBox">
		  
		  <div class="taskSearchBox">
			  <div class="taskSearchOpt">					  
				  <span>작업 검색</span>					 
				  <input type="text" class="taskSearchInput" size="23" placeholder="작업명을 입력해주세요" name="searchTaskName" th:value="${pageVO.cri.searchTaskName}">
			  </div>
			  <div class="taskSearchOpt">					  
				  <span>고객사 검색 </span>
				  <input type="text" class="taskSearchInput" size="23" placeholder="고객사 이름을 입력해주세요" name="searchCustomer" th:value="${pageVO.cri.searchCustomer}">
			  </div>
			  <div class="taskSearchOpt">					  
				  <span>담당자 검색 </span>
				  <input type="text" class="taskSearchInput" size="23" placeholder="담당자 이름을 입력해주세요" name="searchEngineer" th:value="${pageVO.cri.searchEngineer}">
			  </div>
		   	  <div class="taskSearchBtnBox">				 
		      	<input type="button" class="taskSearchBtn" value="검색" style="line-height:0;">
			  </div>
		  </div>
		  
		  <table class="taskListTable">
			  <thead class="taskListHead">
				  <tr class="taskHeadRow">
					  <th class="taskHeads">작업번호</th>
					  <th class="taskHeads">고객사</th>
					  <th class="taskHeads">작업제목</th>
					  <th class="taskHeads">작업일</th>
					  <th class="taskHeads">시작시간</th>
					  <th class="taskHeads">종료시간</th>
					  <th class="taskHeads">담당자</th>
					  <th class="taskHeads">작업상태</th>
					  <th class="taskHeads">비고</th>
				  </tr>
			  </thead>
			  
			  <!--반복 돌릴 것-->
			  <tbody class="taskListBody">
				  <tr th:each="vo, status : ${list}" class="taskBodyRow">
					  <input type="hidden" name="task_id" th:value="${vo.task_id}" readonly>
					  <input type="hidden" name="user_id" th:value="${session.user_id}" readonly>
					  <td class="taskBodies">[[${vo.task_id}]]</td>
					  <td class="taskBodies">[[${vo.user_group}]]</td>
					  <td class="taskBodies">
						  <a href="/task/taskDetail">[[${vo.task_nm}]]</a>
						  <th:block th:if="${change_req_yn == 0}">
							  <i>🔴</i>
						  </th:block>						
					  </td>
					  <td class="taskBodies">[[${vo.task_date}]]</td>
					  <td class="taskBodies">[[${vo.task_st_dt}]]</td>
					  <td class="taskBodies">[[${vo.task_end_dt}]]</td>
					  <td class="taskBodies">[[${vo.user_nm}]]</td>
					  <td class="taskBodies">
						  <input type="button" class="stateBtn" th:value="${vo.status_id}" th:style="${vo.status_color}">
					  </td>
					  <td class="taskBodies">
						  <a th:href="@{taskModify(task_id=${vo.task_id})}" id="taskModiBtn">수정</a>
						  <a href="#" class="taskDelBtn" th:value="${vo.task_id}">삭제</a>						  
					  </td>
				  </tr>

			  </tbody>
		  </table> 
	  </div>
	  
	  <!-- 페이징 -->
	  <th:block th:replace="~{./include/page :: pageNation(${pageVO})}"></th:block>
	  
	</div>
	
	</form>

	
</div>

<script>
	
	//검색이벤트
	const taskSearchBtn = document.querySelector(".taskSearchBtn");
	taskSearchBtn.addEventListener('click', function() {
		
		document.taskSearchForm.action = 'taskList';
		document.taskSearchForm.method = 'get';
		document.taskSearchForm.submit();
		
	});
	
	//
	
	
	
	//삭제이벤트
	const taskDelBtns = document.querySelectorAll(".taskDelBtn");
	taskDelBtns.forEach(function(taskDelBtn) {
		taskDelBtn.addEventListener('click', function(event) {
			event.preventDefault();
			console.log(event.target);
			document.taskSearchForm.action = 'taskDeleteForm';
			document.taskSearchForm.method = 'post';
			document.taskSearchForm.submit();
		})
	})
	
	
	
</script>
	
</th:block>


	
</th:block>







